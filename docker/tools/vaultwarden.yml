version: '3'
services:
  vaultwarden:
    container_name: vaultwarden
    image: vaultwarden/server:1.30.0
    networks:
      - external
    environment:
      TZ: ${TIMEZONE}
      SIGNUPS_ALLOWED: "true"
      DOMAIN: https://bw.${SERVER_DOMAIN}
      SMTP_HOST: ${SMTP_HOST}
      SMTP_FROM: ${SMTP_USER}
      SMTP_PORT: 587
      SMTP_SECURITY: starttls
      SMTP_USERNAME: ${SMTP_USER}
      SMTP_PASSWORD: ${SMTP_PASSWORD}
    volumes:
      - ${APPDATA}/vaultwarden:/data
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
    labels:
      port: 80
      host: bw.${SERVER_DOMAIN}
